{"filter":false,"title":"current_date.sql","tooltip":"/examples/functions/aggregate/current_date.sql","undoManager":{"mark":41,"position":41,"stack":[[{"start":{"row":0,"column":0},"end":{"row":7,"column":17},"action":"remove","lines":["SELECT","\tCOUNT(*) drama_films","FROM","\tfilm","INNER JOIN film_category USING(film_id)","INNER JOIN category USING(category_id)","WHERE","\tcategory_id = 7;"],"id":2},{"start":{"row":0,"column":0},"end":{"row":3,"column":9},"action":"insert","lines":["SELECT","\tCOUNT (DISTINCT amount)","FROM","\tpayment;"]}],[{"start":{"row":0,"column":0},"end":{"row":3,"column":9},"action":"remove","lines":["SELECT","\tCOUNT (DISTINCT amount)","FROM","\tpayment;"],"id":3},{"start":{"row":0,"column":0},"end":{"row":3,"column":9},"action":"insert","lines":["SELECT","\tCOUNT (DISTINCT amount)","FROM","\tpayment;"]}],[{"start":{"row":0,"column":0},"end":{"row":3,"column":9},"action":"remove","lines":["SELECT","\tCOUNT (DISTINCT amount)","FROM","\tpayment;"],"id":4},{"start":{"row":0,"column":0},"end":{"row":6,"column":13},"action":"insert","lines":["SELECT","\tcustomer_id,","\tCOUNT (customer_id)","FROM","\tpayment","GROUP BY","\tcustomer_id;"]}],[{"start":{"row":0,"column":0},"end":{"row":6,"column":13},"action":"remove","lines":["SELECT","\tcustomer_id,","\tCOUNT (customer_id)","FROM","\tpayment","GROUP BY","\tcustomer_id;"],"id":5},{"start":{"row":0,"column":0},"end":{"row":8,"column":26},"action":"insert","lines":["SELECT","\tcustomer_id,","\tCOUNT (customer_id)","FROM","\tpayment","GROUP BY","\tcustomer_id","HAVING","\tCOUNT (customer_id) > 40;"]}],[{"start":{"row":0,"column":0},"end":{"row":8,"column":26},"action":"remove","lines":["SELECT","\tcustomer_id,","\tCOUNT (customer_id)","FROM","\tpayment","GROUP BY","\tcustomer_id","HAVING","\tCOUNT (customer_id) > 40;"],"id":6},{"start":{"row":0,"column":0},"end":{"row":7,"column":14},"action":"insert","lines":["SELECT ","\tname category,","\tMIN(replacement_cost) replacement_cost","FROM category","INNER JOIN film_category USING (category_id)","INNER JOIN film USING (film_id)","GROUP BY name","ORDER BY name;"]}],[{"start":{"row":0,"column":0},"end":{"row":7,"column":14},"action":"remove","lines":["SELECT ","\tname category,","\tMIN(replacement_cost) replacement_cost","FROM category","INNER JOIN film_category USING (category_id)","INNER JOIN film USING (film_id)","GROUP BY name","ORDER BY name;"],"id":7},{"start":{"row":0,"column":0},"end":{"row":8,"column":14},"action":"insert","lines":["SELECT ","\tname category,","\tMIN(replacement_cost) replacement_cost","FROM category","INNER JOIN film_category USING (category_id)","INNER JOIN film USING (film_id)","GROUP BY name","HAVING MIN(replacement_cost) > 9.99","ORDER BY name;"]}],[{"start":{"row":0,"column":0},"end":{"row":8,"column":14},"action":"remove","lines":["SELECT ","\tname category,","\tMIN(replacement_cost) replacement_cost","FROM category","INNER JOIN film_category USING (category_id)","INNER JOIN film USING (film_id)","GROUP BY name","HAVING MIN(replacement_cost) > 9.99","ORDER BY name;"],"id":8},{"start":{"row":0,"column":0},"end":{"row":8,"column":14},"action":"insert","lines":["SELECT ","\tname category,","\tMIN(length) min_length,","\tMAX(length) max_length","FROM category","INNER JOIN film_category USING (category_id)","INNER JOIN film USING (film_id)","GROUP BY name","ORDER BY name;"]}],[{"start":{"row":0,"column":0},"end":{"row":8,"column":14},"action":"remove","lines":["SELECT ","\tname category,","\tMIN(length) min_length,","\tMAX(length) max_length","FROM category","INNER JOIN film_category USING (category_id)","INNER JOIN film USING (film_id)","GROUP BY name","ORDER BY name;"],"id":9},{"start":{"row":0,"column":0},"end":{"row":5,"column":2},"action":"insert","lines":["CREATE TABLE ranks (","\tuser_id INT PRIMARY KEY,","\trank_1 int4 NOT NULL,","\trank_2 int4 NOT NULL,","\trank_3 int4 NOT NULL",");"]}],[{"start":{"row":5,"column":2},"end":{"row":6,"column":0},"action":"insert","lines":["",""],"id":10},{"start":{"row":6,"column":0},"end":{"row":7,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":7,"column":0},"end":{"row":11,"column":14},"action":"insert","lines":["INSERT INTO ranks","VALUES","\t(1, 6, 3, 5),","\t(2, 2, 8, 5),","\t(3, 5, 9, 8);"],"id":11}],[{"start":{"row":11,"column":14},"end":{"row":12,"column":0},"action":"insert","lines":["",""],"id":12},{"start":{"row":12,"column":0},"end":{"row":12,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":12,"column":1},"end":{"row":13,"column":0},"action":"insert","lines":["",""]},{"start":{"row":13,"column":0},"end":{"row":13,"column":1},"action":"insert","lines":["\t"]}],[{"start":{"row":13,"column":0},"end":{"row":17,"column":7},"action":"insert","lines":["SELECT","\tuser_id,","\tLEAST (rank_1, rank_2, rank_3) AS lowest_rank","FROM","\tranks;"],"id":13}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":14}],[{"start":{"row":0,"column":0},"end":{"row":0,"column":27},"action":"insert","lines":["DROP TABLE IF EXISTS ranks;"],"id":15}],[{"start":{"row":0,"column":0},"end":{"row":18,"column":8},"action":"remove","lines":["DROP TABLE IF EXISTS ranks;","CREATE TABLE ranks (","\tuser_id INT PRIMARY KEY,","\trank_1 int4 NOT NULL,","\trank_2 int4 NOT NULL,","\trank_3 int4 NOT NULL",");","","INSERT INTO ranks","VALUES","\t(1, 6, 3, 5),","\t(2, 2, 8, 5),","\t(3, 5, 9, 8);","\t","SELECT","\tuser_id,","\tLEAST (rank_1, rank_2, rank_3) AS lowest_rank","FROM","\tranks;\t"],"id":16},{"start":{"row":0,"column":0},"end":{"row":5,"column":23},"action":"insert","lines":["SELECT ","    COALESCE(SUM(amount),0) AS total","FROM ","    payment","WHERE ","    customer_id = 2000;"]}],[{"start":{"row":0,"column":0},"end":{"row":5,"column":23},"action":"remove","lines":["SELECT ","    COALESCE(SUM(amount),0) AS total","FROM ","    payment","WHERE ","    customer_id = 2000;"],"id":17},{"start":{"row":0,"column":0},"end":{"row":7,"column":16},"action":"insert","lines":["SELECT","\tcustomer_id,","\tSUM (amount) AS total","FROM","\tpayment","GROUP BY","\tcustomer_id","ORDER BY total;\t"]}],[{"start":{"row":7,"column":15},"end":{"row":7,"column":16},"action":"remove","lines":["\t"],"id":18}],[{"start":{"row":0,"column":0},"end":{"row":7,"column":15},"action":"remove","lines":["SELECT","\tcustomer_id,","\tSUM (amount) AS total","FROM","\tpayment","GROUP BY","\tcustomer_id","ORDER BY total;"],"id":19},{"start":{"row":0,"column":0},"end":{"row":8,"column":8},"action":"insert","lines":["SELECT","\tcustomer_id,","\tSUM (amount) AS total","FROM","\tpayment","GROUP BY","\tcustomer_id","ORDER BY total DESC","LIMIT 5;"]}],[{"start":{"row":0,"column":0},"end":{"row":8,"column":8},"action":"remove","lines":["SELECT","\tcustomer_id,","\tSUM (amount) AS total","FROM","\tpayment","GROUP BY","\tcustomer_id","ORDER BY total DESC","LIMIT 5;"],"id":20},{"start":{"row":0,"column":0},"end":{"row":8,"column":19},"action":"insert","lines":["SELECT","\tcustomer_id,","\tSUM (amount) AS total","FROM","\tpayment","GROUP BY","\tcustomer_id","HAVING SUM(amount) > 200","ORDER BY total DESC"]}],[{"start":{"row":0,"column":0},"end":{"row":8,"column":19},"action":"remove","lines":["SELECT","\tcustomer_id,","\tSUM (amount) AS total","FROM","\tpayment","GROUP BY","\tcustomer_id","HAVING SUM(amount) > 200","ORDER BY total DESC"],"id":21},{"start":{"row":0,"column":0},"end":{"row":1,"column":12},"action":"insert","lines":["SELECT SUM(return_date - rental_date )","FROM rental;"]}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":12},"action":"remove","lines":["SELECT SUM(return_date - rental_date )","FROM rental;"],"id":22},{"start":{"row":0,"column":0},"end":{"row":5,"column":19},"action":"insert","lines":["SELECT first_name || ' ' || last_name full_name, ","\t   SUM(return_date - rental_date ) rental_duration","FROM rental","INNER JOIN customer USING(customer_id)","GROUP BY customer_id","ORDER BY full_name;"]}],[{"start":{"row":0,"column":0},"end":{"row":5,"column":19},"action":"remove","lines":["SELECT first_name || ' ' || last_name full_name, ","\t   SUM(return_date - rental_date ) rental_duration","FROM rental","INNER JOIN customer USING(customer_id)","GROUP BY customer_id","ORDER BY full_name;"],"id":23},{"start":{"row":0,"column":0},"end":{"row":14,"column":12},"action":"insert","lines":["SELECT","    f.title,","    STRING_AGG (","\ta.first_name || ' ' || a.last_name,","        ','","       ORDER BY","        a.first_name,","        a.last_name","    ) actors","FROM","    film f","INNER JOIN film_actor fa USING (film_id)","INNER JOIN actor a USING (actor_id)","GROUP BY","    f.title;"]}],[{"start":{"row":0,"column":0},"end":{"row":14,"column":12},"action":"remove","lines":["SELECT","    f.title,","    STRING_AGG (","\ta.first_name || ' ' || a.last_name,","        ','","       ORDER BY","        a.first_name,","        a.last_name","    ) actors","FROM","    film f","INNER JOIN film_actor fa USING (film_id)","INNER JOIN actor a USING (actor_id)","GROUP BY","    f.title;"],"id":24},{"start":{"row":0,"column":0},"end":{"row":11,"column":12},"action":"insert","lines":["SELECT","    country,","    STRING_AGG (email, ';') email_list","FROM","    customer","INNER JOIN address USING (address_id)","INNER JOIN city USING (city_id)","INNER JOIN country USING (country_id)","GROUP BY","    country","ORDER BY","    country;"]}],[{"start":{"row":0,"column":0},"end":{"row":11,"column":12},"action":"remove","lines":["SELECT","    country,","    STRING_AGG (email, ';') email_list","FROM","    customer","INNER JOIN address USING (address_id)","INNER JOIN city USING (city_id)","INNER JOIN country USING (country_id)","GROUP BY","    country","ORDER BY","    country;"],"id":25},{"start":{"row":0,"column":0},"end":{"row":10,"column":10},"action":"insert","lines":["SELECT","    title,","    ARRAY_AGG (first_name || ' ' || last_name) actors","FROM","    film","INNER JOIN film_actor USING (film_id)","INNER JOIN actor USING (actor_id)","GROUP BY","    title","ORDER BY","    title;"]}],[{"start":{"row":0,"column":0},"end":{"row":10,"column":10},"action":"remove","lines":["SELECT","    title,","    ARRAY_AGG (first_name || ' ' || last_name) actors","FROM","    film","INNER JOIN film_actor USING (film_id)","INNER JOIN actor USING (actor_id)","GROUP BY","    title","ORDER BY","    title;"],"id":26},{"start":{"row":0,"column":0},"end":{"row":14,"column":10},"action":"insert","lines":["SELECT","    title,","    ARRAY_AGG (","        first_name || ' ' || last_name","        ORDER BY","            first_name","    ) actors","FROM","    film","INNER JOIN film_actor USING (film_id)","INNER JOIN actor USING (actor_id)","GROUP BY","    title","ORDER BY","    title;"]}],[{"start":{"row":0,"column":0},"end":{"row":14,"column":10},"action":"remove","lines":["SELECT","    title,","    ARRAY_AGG (","        first_name || ' ' || last_name","        ORDER BY","            first_name","    ) actors","FROM","    film","INNER JOIN film_actor USING (film_id)","INNER JOIN actor USING (actor_id)","GROUP BY","    title","ORDER BY","    title;"],"id":27},{"start":{"row":0,"column":0},"end":{"row":15,"column":10},"action":"insert","lines":["SELECT","    title,","    ARRAY_AGG (","        first_name || ' ' || last_name","        ORDER BY","            first_name ASC,","            last_name DESC","    ) actors","FROM","    film","INNER JOIN film_actor USING (film_id)","INNER JOIN actor USING (actor_id)","GROUP BY","    title","ORDER BY","    title;"]}],[{"start":{"row":0,"column":0},"end":{"row":15,"column":10},"action":"remove","lines":["SELECT","    title,","    ARRAY_AGG (","        first_name || ' ' || last_name","        ORDER BY","            first_name ASC,","            last_name DESC","    ) actors","FROM","    film","INNER JOIN film_actor USING (film_id)","INNER JOIN actor USING (actor_id)","GROUP BY","    title","ORDER BY","    title;"],"id":28},{"start":{"row":0,"column":0},"end":{"row":8,"column":0},"action":"insert","lines":["SELECT rental_id,","         customer_id,","         AGE(return_date,","             rental_date) AS duration","FROM rental","WHERE return_date IS NOT NULL","ORDER BY  duration DESC ","LIMIT 10;",""]}],[{"start":{"row":0,"column":0},"end":{"row":8,"column":0},"action":"remove","lines":["SELECT rental_id,","         customer_id,","         AGE(return_date,","             rental_date) AS duration","FROM rental","WHERE return_date IS NOT NULL","ORDER BY  duration DESC ","LIMIT 10;",""],"id":29},{"start":{"row":0,"column":0},"end":{"row":4,"column":2},"action":"insert","lines":["CREATE TABLE delivery(","    delivery_id serial PRIMARY KEY,","    product varchar(255) NOT NULL,","    delivery_date DATE DEFAULT CURRENT_DATE",");"]}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":30}],[{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"insert","lines":["D"],"id":31},{"start":{"row":0,"column":1},"end":{"row":0,"column":2},"action":"insert","lines":["R"]},{"start":{"row":0,"column":2},"end":{"row":0,"column":3},"action":"insert","lines":["O"]},{"start":{"row":0,"column":3},"end":{"row":0,"column":4},"action":"insert","lines":["P"]}],[{"start":{"row":0,"column":4},"end":{"row":0,"column":5},"action":"insert","lines":[" "],"id":32},{"start":{"row":0,"column":5},"end":{"row":0,"column":6},"action":"insert","lines":["T"]},{"start":{"row":0,"column":6},"end":{"row":0,"column":7},"action":"insert","lines":["A"]},{"start":{"row":0,"column":7},"end":{"row":0,"column":8},"action":"insert","lines":["B"]}],[{"start":{"row":0,"column":8},"end":{"row":0,"column":9},"action":"insert","lines":["L"],"id":33},{"start":{"row":0,"column":9},"end":{"row":0,"column":10},"action":"insert","lines":["E"]}],[{"start":{"row":0,"column":10},"end":{"row":0,"column":11},"action":"insert","lines":[" "],"id":34},{"start":{"row":0,"column":11},"end":{"row":0,"column":12},"action":"insert","lines":["d"]},{"start":{"row":0,"column":12},"end":{"row":0,"column":13},"action":"insert","lines":["e"]},{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"insert","lines":["v"]},{"start":{"row":0,"column":14},"end":{"row":0,"column":15},"action":"insert","lines":["i"]}],[{"start":{"row":0,"column":14},"end":{"row":0,"column":15},"action":"remove","lines":["i"],"id":35},{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"remove","lines":["v"]}],[{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"insert","lines":["l"],"id":36}],[{"start":{"row":0,"column":11},"end":{"row":0,"column":14},"action":"remove","lines":["del"],"id":37},{"start":{"row":0,"column":11},"end":{"row":0,"column":19},"action":"insert","lines":["delivery"]}],[{"start":{"row":0,"column":19},"end":{"row":0,"column":20},"action":"insert","lines":[" "],"id":38},{"start":{"row":0,"column":20},"end":{"row":0,"column":21},"action":"insert","lines":["I"]},{"start":{"row":0,"column":21},"end":{"row":0,"column":22},"action":"insert","lines":["F"]}],[{"start":{"row":0,"column":22},"end":{"row":0,"column":23},"action":"insert","lines":[" "],"id":39},{"start":{"row":0,"column":23},"end":{"row":0,"column":24},"action":"insert","lines":["E"]},{"start":{"row":0,"column":24},"end":{"row":0,"column":25},"action":"insert","lines":["S"]}],[{"start":{"row":0,"column":24},"end":{"row":0,"column":25},"action":"remove","lines":["S"],"id":40}],[{"start":{"row":0,"column":24},"end":{"row":0,"column":25},"action":"insert","lines":["x"],"id":41}],[{"start":{"row":0,"column":24},"end":{"row":0,"column":25},"action":"remove","lines":["x"],"id":42}],[{"start":{"row":0,"column":24},"end":{"row":0,"column":25},"action":"insert","lines":["X"],"id":43},{"start":{"row":0,"column":25},"end":{"row":0,"column":26},"action":"insert","lines":["I"]},{"start":{"row":0,"column":26},"end":{"row":0,"column":27},"action":"insert","lines":["S"]},{"start":{"row":0,"column":27},"end":{"row":0,"column":28},"action":"insert","lines":["T"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":5,"column":2},"end":{"row":5,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1637348977138,"hash":"e4ef6f6584a0b1a1f22295cd95e4f24c6f052329"}