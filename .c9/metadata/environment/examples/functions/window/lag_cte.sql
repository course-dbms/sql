{"filter":false,"title":"lag_cte.sql","tooltip":"/examples/functions/window/lag_cte.sql","undoManager":{"mark":3,"position":3,"stack":[[{"start":{"row":0,"column":0},"end":{"row":16,"column":43},"action":"remove","lines":["SELECT","\tproduct_name,","\tgroup_name,","\tprice,","\tLAG (price, 1) OVER (","\t\tPARTITION BY group_name","\t\tORDER BY","\t\t\tprice","\t) AS prev_price,","\tprice - LAG (price, 1) OVER (","\t\tPARTITION BY group_name","\t\tORDER BY","\t\t\tprice","\t) AS cur_prev_diff","FROM","\tproducts","INNER JOIN product_groups USING (group_id);"],"id":2},{"start":{"row":0,"column":0},"end":{"row":16,"column":0},"action":"insert","lines":["WITH cte AS (","\tSELECT ","\t\tyear, ","\t\tSUM(amount) amount","\tFROM sales","\tGROUP BY year","\tORDER BY year",") ","SELECT","\tyear, ","\tamount,","\tLAG(amount,1) OVER (","\t\tORDER BY year","\t) previous_year_sales","FROM","\tcte;",""]}],[{"start":{"row":4,"column":11},"end":{"row":4,"column":12},"action":"insert","lines":["_"],"id":3},{"start":{"row":4,"column":12},"end":{"row":4,"column":13},"action":"insert","lines":["s"]}],[{"start":{"row":4,"column":13},"end":{"row":4,"column":14},"action":"insert","lines":["t"],"id":4},{"start":{"row":4,"column":14},"end":{"row":4,"column":15},"action":"insert","lines":["a"]},{"start":{"row":4,"column":15},"end":{"row":4,"column":16},"action":"insert","lines":["t"]},{"start":{"row":4,"column":16},"end":{"row":4,"column":17},"action":"insert","lines":["s"]}],[{"start":{"row":4,"column":16},"end":{"row":4,"column":17},"action":"remove","lines":["s"],"id":5},{"start":{"row":4,"column":15},"end":{"row":4,"column":16},"action":"remove","lines":["t"]},{"start":{"row":4,"column":14},"end":{"row":4,"column":15},"action":"remove","lines":["a"]},{"start":{"row":4,"column":13},"end":{"row":4,"column":14},"action":"remove","lines":["t"]},{"start":{"row":4,"column":12},"end":{"row":4,"column":13},"action":"remove","lines":["s"]},{"start":{"row":4,"column":11},"end":{"row":4,"column":12},"action":"remove","lines":["_"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":4,"column":11},"end":{"row":4,"column":11},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1637677202063,"hash":"081f5b11355e7d54d478c79e6ac35d560414edbf"}